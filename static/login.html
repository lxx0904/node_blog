<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="chrome=1">
		<meta name="description" content="">
		<meta name="format-detection" content="telephone=no">
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<title>demo</title>
		<link rel="stylesheet" type="text/css" href="common/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="common/css/style.css" />
	</head>

	<body>

		<body>
			<div class="login">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">登陆</h3>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="username">用户名</label>
							<input type="email" class="form-control" id="username" placeholder="请输入用户名">
						</div>
						<div class="form-group">
							<label for="pwd">密码</label>
							<input type="password" class="form-control" id="pwd" placeholder="请输入密码">
						</div>
					</div>
					<div class="panel-footer">
						<a href="javascript:login();" class="btn btn-success">登陆</a>（账号不存在，直接注册）
					</div>
				</div>
				<ul class="bg-bubbles">
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
				</ul>
			</div>
		</body>
		<script src="common/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			function login() {
				var username = $("#username").val(),
					pwd = $("#pwd").val();
				if(username === "") {
					alert("请输入用户名");
				} else if(pwd === "") {
					alert("请输入密码");
				} else {
					$.ajax({
						url: "http://localhost:3000/api/user/userLogin",
						type: "post",
						timeout: 20000,
						dataType: "json",
						data: {
							username: username,
							pwd: pwd
						},
						success: function(data) {
							if(data.code === 1) {
								if(data.result.length > 0) {
									alert("登陆成功！");
								} else {
									addUser(username, pwd);
								}
							} else {
								alert(data.msg);
							}
						}
					});
				}
			}

			function addUser(username, pwd) {
				$.ajax({
					url: "http://localhost:3000/api/user/addUser",
					type: "post",
					timeout: 20000,
					dataType: "json",
					data: {
						username: username,
						pwd: pwd
					},
					success: function(data) {
						if(data.code === 1) {
							alert("注册成功！");
						} else {
							alert(data.msg);
						}
					}
				});
			}
		</script>
	</body>

</html>